// Mock AI 분석 결과 데이터
const MOCK_AI_ANALYSIS = {
    '01869517': {
        comprehensive: {
            summary: `종합소견: 김건강님의 건강검진 결과 분석

【주요 소견】
1. 체중 관리 필요
   - BMI 25.0 (과체중): 정상 범위 18.5~22.9를 초과
   - 체지방율 22.2% (높음): 정상 범위 11~20%를 초과
   - 복부비만은 없으나 전반적인 체중 관리가 필요한 상태

2. 고지혈증 초기 단계
   - 총콜레스테롤 210 mg/dL: 권장치 200 미만 초과
   - LDL 콜레스테롤 135 mg/dL: 권장치 130 미만 초과
   - 심혈관 질환 위험도 증가 가능성

3. 정상 소견
   - 혈압: 수축기 132, 이완기 79 (정상 범위)
   - 간기능, 신기능: 모두 정상 범위
   - 혈액검사: 정상 소견

【권고사항】
✓ 체중 감량 (목표: 5~7kg 감량으로 BMI 22 이하 달성)
✓ 저지방, 저콜레스테롤 식이 요법
✓ 주 3~5회, 30분 이상 유산소 운동
✓ 3개월 후 추적 검사로 고지혈증 재평가
✓ 금연 및 절주 권장

【추적 검사 일정】
- 3개월 후: 고지혈증 추적 검사
- 1년 후: 종합검진 재검사`,
            generatedAt: '2025-11-07 14:23:15'
        },
        byGroup: {
            '신체계측': `신체계측 AI 분석 결과:

BMI 25.0으로 과체중 상태이며, 체지방율 22.2%로 정상 범위를 초과하고 있습니다.
허리둘레는 89cm로 복부비만 기준(남성 90cm) 이하이나 경계선에 있습니다.

대사증후군 예방을 위해 체중 감량이 필요하며, 목표 체중은 약 62~65kg (BMI 22 기준) 입니다.
규칙적인 운동과 식이 조절을 통해 3~6개월 내 5~7kg 감량을 권장합니다.`,
            '혈압': `혈압 측정 결과 수축기 132mmHg, 이완기 79mmHg로 정상 범위 내에 있습니다.

고혈압 전단계는 아니나, 체중 관리를 통해 향후 고혈압 발생을 예방할 수 있습니다.
정기적인 혈압 측정과 건강한 생활습관 유지가 중요합니다.`,
            '혈액검사': `혈액검사 결과 모든 항목이 정상 범위 내에 있습니다.

백혈구, 적혈구, 혈색소, 혈소판 모두 정상으로 빈혈이나 감염 소견 없습니다.
면역 기능 및 조혈 기능이 양호한 상태입니다.`,
            '고지혈검사': `고지혈 검사에서 이상 소견이 발견되었습니다.

• 총콜레스테롤 210 mg/dL (정상: <200)
• LDL 콜레스테롤 135 mg/dL (정상: <130)

고지혈증 초기 단계로 판단되며, 식이 조절과 운동으로 개선 가능합니다.
포화지방 섭취를 줄이고, 오메가-3 지방산이 풍부한 생선 섭취를 늘리세요.
3개월 후 추적 검사가 필요하며, 개선되지 않으면 약물 치료를 고려해야 합니다.`
        }
    },
    '04739580': {
        comprehensive: {
            summary: `종합소견: 이슬기님의 건강검진 결과 분석

【주요 소견】
1. 마른 비만 (Sarcopenic Obesity)
   - BMI 18.3 (저체중): 정상 범위 18.5~22.9 미만
   - 체지방율 31.2% (높음): 정상 범위 21~30%를 초과
   - 근육량 부족 + 체지방 과다 = 마른 비만 상태

2. 정상 소견
   - 혈압: 수축기 108, 이완기 68 (정상)
   - 혈액검사: 모든 항목 정상
   - 갑상선 기능: 정상

【권고사항】
✓ 근력 운동을 통한 근육량 증가 (주 3회 이상)
✓ 단백질 섭취 증가 (체중 1kg당 1.2~1.5g)
✓ 저강도 유산소 운동 (과도한 유산소 운동 지양)
✓ 영양 상담을 통한 균형 잡힌 식단 구성
✓ 6개월 후 체성분 재검사

【주의사항】
마른 비만은 외관상 건강해 보이지만, 대사 질환 위험이 높습니다.
근육량 증가에 초점을 맞춘 운동과 영양 관리가 필수적입니다.`,
            generatedAt: '2025-11-07 15:10:42'
        },
        byGroup: {
            '신체계측': `신체계측 분석 결과 마른 비만(Sarcopenic Obesity) 소견:

BMI 18.3으로 저체중이지만, 체지방율이 31.2%로 매우 높은 상태입니다.
이는 근육량이 부족하고 체지방이 과다한 '마른 비만' 상태를 의미합니다.

근력 운동을 통해 근육량을 늘리고, 고단백 식단으로 영양 상태를 개선해야 합니다.
무리한 다이어트나 과도한 유산소 운동은 오히려 근육 손실을 초래할 수 있으므로 주의하세요.`,
            '갑상선기능검사': `갑상선 기능 검사 결과 모두 정상입니다.

TSH 2.8 μIU/mL, Free T4 1.2 ng/dL로 정상 범위 내에 있어
갑상선 기능 저하나 항진은 없습니다.

저체중의 원인이 갑상선 질환은 아니므로, 식습관 및 생활습관 개선에 집중하세요.`
        }
    },
    '05550346': {
        comprehensive: {
            summary: `종합소견: 박민수님의 건강검진 결과 분석

【주요 소견】
1. 당뇨 전단계 (Pre-diabetes)
   - 공복혈당 105 mg/dL: 정상 상한(100) 초과
   - 당화혈색소(HbA1c) 5.8%: 정상(<5.7) 초과
   - 당뇨병으로 진행될 위험 있음

2. 과체중 경향
   - BMI 23.5: 정상 상한 근접 (정상 18.5~22.9)
   - 체지방율 21.7%: 정상 범위(11~20) 초과

3. 정상 소견
   - 혈압: 정상 범위
   - 혈액검사: 정상 소견

【권고사항】
✓ 당뇨 전단계 관리 (매우 중요!)
  - 탄수화물 섭취 조절 (현미, 통곡물 위주)
  - 단순당 섭취 최소화 (음료수, 과자, 빵 등)
  - 식후 운동 (식후 30분 내 가벼운 산책)
✓ 체중 감량 (목표: 3~5kg 감량)
✓ 주 5회 이상, 30분 이상 유산소 운동
✓ 3개월 후 공복혈당 및 당화혈색소 추적 검사 필수
✓ 가족력 확인 (당뇨병 가족력이 있으면 더욱 주의)

【추적 검사 일정】
- 3개월 후: 공복혈당, 당화혈색소 재검사
- 6개월 후: 당부하검사 고려
- 1년 후: 종합검진`,
            generatedAt: '2025-11-07 16:05:18'
        },
        byGroup: {
            '신체계측': `신체계측 결과 BMI 23.5로 정상 범위 상한에 근접해 있으며,
체지방율 21.7%로 정상 범위를 약간 초과하고 있습니다.

당뇨 전단계 관리를 위해 체중 감량이 매우 중요합니다.
3~5kg 감량을 목표로 하며, 이를 통해 인슐린 저항성을 개선할 수 있습니다.`,
            '당뇨검사': `당뇨 검사에서 이상 소견이 발견되었습니다.

• 공복혈당 105 mg/dL (정상: 70~100)
• 당화혈색소 5.8% (정상: <5.7)

이는 '당뇨 전단계(Pre-diabetes)' 상태로, 적극적인 관리가 없으면
5년 내 당뇨병으로 진행될 확률이 높습니다.

【긴급 권고사항】
1. 탄수화물 섭취 조절 (하루 섭취량의 50~60%로 제한)
2. 단순당 완전 배제 (음료수, 과자, 빵, 과일주스)
3. 규칙적인 운동 (특히 식후 운동이 중요)
4. 3개월 후 반드시 재검사
5. 필요시 내분비내과 진료 고려

지금 관리하면 당뇨병 발생을 예방할 수 있습니다!`
        }
    }
};

// AI 분석 결과 조회
function getAIAnalysis(patientId) {
    return MOCK_AI_ANALYSIS[patientId] || null;
}

// 특정 그룹의 AI 분석 조회
function getAIAnalysisByGroup(patientId, groupName) {
    const analysis = MOCK_AI_ANALYSIS[patientId];
    if (!analysis || !analysis.byGroup) return null;
    return analysis.byGroup[groupName];
}

// 종합 소견 조회
function getComprehensiveAnalysis(patientId) {
    const analysis = MOCK_AI_ANALYSIS[patientId];
    if (!analysis || !analysis.comprehensive) return null;
    return analysis.comprehensive;
}

// Mock 프롬프트 데이터
const MOCK_PROMPTS = {
    testPrompts: {
        '신체계측': `당신은 건강검진 전문의입니다. 다음 신체계측 결과를 분석하여 의학적 소견을 작성해주세요.

【분석 항목】
- BMI와 체지방율을 종합하여 비만도 평가
- 복부비만 여부 판단 (허리둘레 기준)
- 대사증후군 위험도 평가
- 적정 체중 및 감량/증량 목표 제시

【출력 형식】
- 현재 상태 요약
- 의학적 해석
- 구체적인 권고사항`,
        '혈압': `혈압 측정 결과를 분석하여 심혈관 건강 상태를 평가해주세요.

【분석 기준】
- 정상: <120/80
- 고혈압 전단계: 120-139/80-89
- 1기 고혈압: 140-159/90-99
- 2기 고혈압: ≥160/100

【포함 내용】
- 현재 혈압 상태 평가
- 위험도 분석
- 생활습관 개선 권고`,
        '혈액검사': `혈액검사 결과를 종합하여 전반적인 건강 상태를 평가해주세요.

【분석 항목】
- 빈혈 여부 (Hb, RBC)
- 감염/염증 소견 (WBC)
- 출혈 경향 (혈소판)

【권고사항】
- 이상 소견 시 추가 검사 필요성
- 생활습관 개선 방안`,
        '고지혈검사': `고지혈 검사 결과를 분석하여 심혈관 질환 위험도를 평가해주세요.

【평가 항목】
- 총콜레스테롤, LDL, HDL, 중성지방
- 동맥경화 위험도
- 식이요법 필요성
- 약물치료 고려 시점`
    },
    masterPrompt: `당신은 종합검진 전문의입니다.
각 검사별 AI 분석 결과를 종합하여 환자의 전반적인 건강 상태를 평가하고,
우선순위가 높은 건강 문제를 파악하여 종합소견을 작성해주세요.

【종합소견 작성 지침】
1. 주요 소견 요약 (정상/이상 소견 구분)
2. 우선순위별 건강 문제 나열
3. 질환 간 상관관계 분석
4. 구체적이고 실천 가능한 권고사항
5. 추적 검사 일정 제시

【권고사항 작성 원칙】
- 구체적인 수치와 목표 제시
- 실천 가능한 생활습관 개선 방안
- 필요시 전문 진료과 안내
- 긴급도에 따른 우선순위 표시

【출력 형식】
- 종합소견 (300~500자)
- 주요 소견 (항목별 정리)
- 권고사항 (우선순위별 정리)
- 추적 검사 일정`
};

// 프롬프트 조회
function getPrompt(type, testGroup = null) {
    if (type === 'master') {
        return MOCK_PROMPTS.masterPrompt;
    } else if (type === 'test' && testGroup) {
        return MOCK_PROMPTS.testPrompts[testGroup] || '';
    }
    return '';
}

// 프롬프트 저장 (localStorage 활용)
function savePrompt(type, content, testGroup = null) {
    const key = type === 'master' ? 'masterPrompt' : `testPrompt_${testGroup}`;
    localStorage.setItem(key, content);
    return true;
}

// 저장된 프롬프트 불러오기
function loadPrompt(type, testGroup = null) {
    const key = type === 'master' ? 'masterPrompt' : `testPrompt_${testGroup}`;
    const saved = localStorage.getItem(key);
    return saved || getPrompt(type, testGroup);
}
