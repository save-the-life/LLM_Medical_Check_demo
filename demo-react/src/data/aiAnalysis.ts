import type { AIAnalysis, TestGroup, Prompts } from '../types';

// Mock AI 분석 결과 데이터
export const MOCK_AI_ANALYSIS: Record<string, AIAnalysis> = {
  '01869517': {
    comprehensive: {
      summary: `종합소견: 김건강님의 건강검진 결과 분석

【주요 소견】
1. 체중 관리 필요
   - BMI 25.0 (과체중): 정상 범위 18.5~22.9를 초과
   - 체지방율 22.2% (높음): 정상 범위 11~20%를 초과
   - 복부비만은 없으나 전반적인 체중 관리가 필요한 상태

2. 고지혈증 초기 단계
   - 총콜레스테롤 210 mg/dL: 권장치 200 미만 초과
   - LDL 콜레스테롤 135 mg/dL: 권장치 130 미만 초과
   - 심혈관 질환 위험도 증가 가능성

3. 정상 소견
   - 혈압: 수축기 132, 이완기 79 (정상 범위)
   - 간기능, 신기능: 모두 정상 범위
   - 혈액검사: 정상 소견

【권고사항】
✓ 체중 감량 (목표: 5~7kg 감량으로 BMI 22 이하 달성)
✓ 저지방, 저콜레스테롤 식이 요법
✓ 주 3~5회, 30분 이상 유산소 운동
✓ 3개월 후 추적 검사로 고지혈증 재평가
✓ 금연 및 절주 권장

【추적 검사 일정】
- 3개월 후: 고지혈증 추적 검사
- 1년 후: 종합검진 재검사`,
      generatedAt: '2025-11-07 14:23:15'
    },
    byGroup: {
      '신체계측': `신체계측 AI 분석 결과:

BMI 25.0으로 과체중 상태이며, 체지방율 22.2%로 정상 범위를 초과하고 있습니다.
허리둘레는 89cm로 복부비만 기준(남성 90cm) 이하이나 경계선에 있습니다.

대사증후군 예방을 위해 체중 감량이 필요하며, 목표 체중은 약 62~65kg (BMI 22 기준) 입니다.
규칙적인 운동과 식이 조절을 통해 3~6개월 내 5~7kg 감량을 권장합니다.`,
      '혈압': `혈압 측정 결과 수축기 132mmHg, 이완기 79mmHg로 정상 범위 내에 있습니다.

고혈압 전단계는 아니나, 체중 관리를 통해 향후 고혈압 발생을 예방할 수 있습니다.
정기적인 혈압 측정과 건강한 생활습관 유지가 중요합니다.`,
      '혈액검사': `혈액검사 결과 모든 항목이 정상 범위 내에 있습니다.

백혈구, 적혈구, 혈색소, 혈소판 모두 정상으로 빈혈이나 감염 소견 없습니다.
면역 기능 및 조혈 기능이 양호한 상태입니다.`,
      '고지혈검사': `고지혈 검사에서 이상 소견이 발견되었습니다.

• 총콜레스테롤 210 mg/dL (정상: <200)
• LDL 콜레스테롤 135 mg/dL (정상: <130)

고지혈증 초기 단계로 판단되며, 식이 조절과 운동으로 개선 가능합니다.
포화지방 섭취를 줄이고, 오메가-3 지방산이 풍부한 생선 섭취를 늘리세요.
3개월 후 추적 검사가 필요하며, 개선되지 않으면 약물 치료를 고려해야 합니다.`
    }
  },
  '04739580': {
    comprehensive: {
      summary: `종합소견: 이슬기님의 건강검진 결과 분석

【주요 소견】
1. 마른 비만 (Sarcopenic Obesity)
   - BMI 18.3 (저체중): 정상 범위 18.5~22.9 미만
   - 체지방율 31.2% (높음): 정상 범위 21~30%를 초과
   - 근육량 부족 + 체지방 과다 = 마른 비만 상태

2. 정상 소견
   - 혈압: 수축기 108, 이완기 68 (정상)
   - 혈액검사: 모든 항목 정상
   - 갑상선 기능: 정상

【권고사항】
✓ 근력 운동을 통한 근육량 증가 (주 3회 이상)
✓ 단백질 섭취 증가 (체중 1kg당 1.2~1.5g)
✓ 저강도 유산소 운동 (과도한 유산소 운동 지양)
✓ 영양 상담을 통한 균형 잡힌 식단 구성
✓ 6개월 후 체성분 재검사

【주의사항】
마른 비만은 외관상 건강해 보이지만, 대사 질환 위험이 높습니다.
근육량 증가에 초점을 맞춘 운동과 영양 관리가 필수적입니다.`,
      generatedAt: '2025-11-07 15:10:42'
    },
    byGroup: {
      '신체계측': `신체계측 분석 결과 마른 비만(Sarcopenic Obesity) 소견:

BMI 18.3으로 저체중이지만, 체지방율이 31.2%로 매우 높은 상태입니다.
이는 근육량이 부족하고 체지방이 과다한 '마른 비만' 상태를 의미합니다.

근력 운동을 통해 근육량을 늘리고, 고단백 식단으로 영양 상태를 개선해야 합니다.
무리한 다이어트나 과도한 유산소 운동은 오히려 근육 손실을 초래할 수 있으므로 주의하세요.`,
      '갑상선기능검사': `갑상선 기능 검사 결과 모두 정상입니다.

TSH 2.8 μIU/mL, Free T4 1.2 ng/dL로 정상 범위 내에 있어
갑상선 기능 저하나 항진은 없습니다.

저체중의 원인이 갑상선 질환은 아니므로, 식습관 및 생활습관 개선에 집중하세요.`
    }
  },
  '05550346': {
    comprehensive: {
      summary: `종합소견: 박민수님의 건강검진 결과 분석

【주요 소견】
1. 당뇨 전단계 (Pre-diabetes)
   - 공복혈당 108 mg/dL: 정상 상한(100) 초과
   - 당화혈색소(HbA1c) 5.9%: 정상(<5.7) 초과
   - 당뇨병으로 진행될 위험 있음

2. 과체중 및 복부비만
   - BMI 26.5: 과체중 (정상 18.5~22.9)
   - 체지방율 25.8%: 정상 범위(11~20) 초과
   - 허리둘레 95cm: 복부비만 기준(90cm) 초과

3. 간기능 경도 이상
   - ALT 45 U/L: 정상 범위(0~40) 초과
   - r-GTP 52 U/L: 정상 범위(0~50) 초과

【권고사항】
✓ 당뇨 전단계 관리 (매우 중요!)
  - 탄수화물 섭취 조절 (현미, 통곡물 위주)
  - 단순당 섭취 최소화 (음료수, 과자, 빵 등)
  - 식후 운동 (식후 30분 내 가벼운 산책)
✓ 체중 감량 (목표: 7~10kg 감량)
✓ 주 5회 이상, 30분 이상 유산소 운동
✓ 3개월 후 공복혈당 및 당화혈색소 추적 검사 필수
✓ 간 건강 관리 (절주, 간 기능 재검사)

【추적 검사 일정】
- 3개월 후: 공복혈당, 당화혈색소, 간기능 재검사
- 6개월 후: 당부하검사 고려
- 1년 후: 종합검진`,
      generatedAt: '2025-11-07 16:45:30'
    },
    byGroup: {
      '신체계측': `신체계측 결과 BMI 26.5로 과체중이며, 허리둘레 95cm로 복부비만 기준을 초과하고 있습니다.
체지방율 25.8%로 정상 범위를 크게 초과하고 있습니다.

당뇨 전단계 관리를 위해 체중 감량이 매우 중요합니다.
7~10kg 감량을 목표로 하며, 이를 통해 인슐린 저항성을 개선할 수 있습니다.`,
      '당뇨검사': `당뇨 검사에서 이상 소견이 발견되었습니다.

• 공복혈당 108 mg/dL (정상: 70~100)
• 당화혈색소 5.9% (정상: <5.7)

이는 '당뇨 전단계(Pre-diabetes)' 상태로, 적극적인 관리가 없으면
5년 내 당뇨병으로 진행될 확률이 높습니다.

생활습관 개선만으로도 충분히 정상으로 회복 가능하므로,
식이조절과 운동을 지금 바로 시작하시기 바랍니다.`
    }
  }
};

// 검사 그룹 목록
export const TEST_GROUPS: TestGroup[] = [
  { name: '신체계측', icon: 'fa-weight-scale' },
  { name: '혈압', icon: 'fa-heart-pulse' },
  { name: '혈액검사', icon: 'fa-droplet' },
  { name: '간기능검사', icon: 'fa-flask' },
  { name: '신기능검사', icon: 'fa-kidneys' },
  { name: '고지혈검사', icon: 'fa-chart-line' },
  { name: '당뇨검사', icon: 'fa-syringe' },
  { name: '갑상선기능검사', icon: 'fa-pills' },
  { name: '소변검사', icon: 'fa-vial' }
];

// 프롬프트 템플릿
export const MOCK_PROMPTS: Prompts = {
  master: `당신은 의료 전문가로서 건강검진 결과를 종합 분석하여 환자에게 명확하고 이해하기 쉬운 소견을 작성합니다.

다음 검사 결과들을 종합하여 환자의 전반적인 건강 상태를 평가하고, 주요 소견, 권고사항, 추적 검사 일정을 제시하세요.

【작성 지침】
1. 주요 소견: 참고치를 벗어난 항목을 우선순위로 나열
2. 정상 소견: 정상 범위 내 항목들을 간략히 언급
3. 권고사항: 구체적이고 실천 가능한 생활습관 개선 방안 제시
4. 추적 검사: 필요한 재검사 항목과 시기 명시
5. 질환 간 연관성: 여러 항목이 서로 영향을 미치는 경우 설명

환자가 이해하기 쉬운 용어를 사용하되, 의학적 정확성을 유지하세요.`,

  tests: {
    '신체계측': `신체계측 결과를 분석하여 환자의 체중 상태를 평가하세요.

【분석 항목】
- BMI (체질량지수): 저체중/정상/과체중/비만 판정
- 체지방율: 정상 범위 대비 평가
- 허리둘레: 복부비만 기준 대비 평가

【소견 작성】
1. 현재 체중 상태 판정
2. 대사증후군 위험도 평가
3. 목표 체중 및 감량/증량 권고
4. 구체적인 식이/운동 방법 제시`,

    '혈압': `혈압 측정 결과를 분석하세요.

【분석 항목】
- 수축기 혈압
- 이완기 혈압
- 맥박

【소견 작성】
1. 정상/고혈압 전단계/고혈압 판정
2. 심혈관 질환 위험도 평가
3. 생활습관 개선 권고
4. 추적 검사 필요성`,

    '혈액검사': `혈액 검사 결과를 분석하세요.

【분석 항목】
- 백혈구(WBC): 감염, 염증 평가
- 적혈구(RBC): 빈혈, 탈수 평가
- 혈색소(Hb): 산소 운반 능력
- 혈소판: 지혈 기능

【소견 작성】
1. 각 항목의 정상/이상 판정
2. 빈혈, 감염 등 질환 가능성
3. 추가 검사 필요성`,

    '간기능검사': `간기능 검사 결과를 분석하세요.

【분석 항목】
- AST, ALT: 간세포 손상 지표
- r-GTP: 담도계 손상 지표

【소견 작성】
1. 간기능 상태 평가
2. 지방간, 간염 등 가능성
3. 음주, 약물 복용 관련 주의사항
4. 추적 검사 및 생활습관 개선`,

    '신기능검사': `신기능 검사 결과를 분석하세요.

【분석 항목】
- BUN: 신장의 노폐물 배설 기능
- Creatinine: 신장 여과 기능

【소견 작성】
1. 신기능 상태 평가
2. 만성 신부전 위험도
3. 수분 섭취, 식이 관리 권고`,

    '고지혈검사': `고지혈 검사 결과를 분석하세요.

【분석 항목】
- 총콜레스테롤
- HDL (좋은 콜레스테롤)
- LDL (나쁜 콜레스테롤)
- 중성지방(TG)

【소견 작성】
1. 고지혈증 진단 및 단계
2. 심혈관 질환 위험도
3. 식이 조절 방법 (포화지방, 오메가-3)
4. 약물 치료 필요성`,

    '당뇨검사': `당뇨 검사 결과를 분석하세요.

【분석 항목】
- 공복혈당
- 당화혈색소(HbA1c)

【소견 작성】
1. 정상/당뇨 전단계/당뇨병 판정
2. 인슐린 저항성 평가
3. 탄수화물 섭취 조절 방법
4. 추적 검사 일정 (3개월, 6개월)`,

    '갑상선기능검사': `갑상선 기능 검사 결과를 분석하세요.

【분석 항목】
- TSH (갑상선 자극 호르몬)
- Free T4 (유리 티록신)

【소견 작성】
1. 갑상선 기능 정상/저하/항진 판정
2. 관련 증상 (체중 변화, 피로감 등)
3. 추가 검사 필요성
4. 약물 치료 고려`,

    '소변검사': `소변 검사 결과를 분석하세요.

【분석 항목】
- 단백뇨: 신장 질환
- 당뇨: 당뇨병
- 잠혈: 요로계 질환

【소견 작성】
1. 각 항목의 이상 소견
2. 신장, 요로계 질환 가능성
3. 추가 검사 필요성`
  }
};

// 유틸리티 함수들
export const getAIAnalysis = (patientId: string): AIAnalysis | null => {
  return MOCK_AI_ANALYSIS[patientId] || null;
};

export const getComprehensiveAnalysis = (patientId: string) => {
  const analysis = MOCK_AI_ANALYSIS[patientId];
  return analysis?.comprehensive || null;
};

export const getAIAnalysisByGroup = (patientId: string, groupName: string): string | null => {
  const analysis = MOCK_AI_ANALYSIS[patientId];
  if (!analysis) return null;

  return analysis.byGroup[groupName] || null;
};

export const getPrompt = (type: 'master' | 'test', testName?: string): string => {
  if (type === 'master') {
    return MOCK_PROMPTS.master;
  }
  return testName ? MOCK_PROMPTS.tests[testName] || '' : '';
};

export const loadPrompt = (type: 'master' | 'test', testName?: string): string => {
  const key = type === 'master' ? 'master_prompt' : `test_prompt_${testName}`;
  const stored = localStorage.getItem(key);
  return stored || getPrompt(type, testName);
};

export const savePrompt = (type: 'master' | 'test', content: string, testName?: string): void => {
  const key = type === 'master' ? 'master_prompt' : `test_prompt_${testName}`;
  localStorage.setItem(key, content);
};
